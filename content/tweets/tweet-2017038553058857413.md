---
type: tweet
title: "Inside Clawdbot Architecture: How AI Agents Handle Execution, Tools, and Memory"
tweetId: "2017038553058857413"
tweetUrl: "https://x.com/Hesamation/status/2017038553058857413"
tweetText: "I took a look inside Clawdbot (aka Moltbot) architecture and how it handles agent executions, tool use, browser, etc. there are many lessons to learn for AI engineers."
author: hesamation
tweetedAt: 2025-04-25
tags:
  - ai-agents
  - architecture
  - claude-code
  - llm
  - developer-experience
  - software-architecture
---

Deep technical breakdown of how an AI CLI agent (pseudonymously called "Clawdbot") works under the hood.

## Architecture Flow

1. **Channel Adapter** - Normalizes messages from different input sources (Telegram, WhatsApp, Slack)
2. **Gateway Server** - Task/session coordinator, the heart of the system
3. **Agent Runner** - Assembles system prompt with tools, skills, memory, session history
4. **LLM API Call** - Streams responses with provider abstraction
5. **Agentic Loop** - Executes tool calls until final text or max turns (~20)
6. **Response Path** - Returns responses, persists session as JSONL

## Key Insight: Lane-Based Command Queue

Uses serialization by default instead of async/await parallelization:

> "The mental model shifts from 'what do I need to lock?' to 'what's safe to parallelize?'"

This aligns with Cognition's "Don't Build Multi-Agents" philosophy - simple async per agent leads to interleaved garbage logs and race conditions.

## Memory System

- **Session transcripts** in JSONL format
- **Memory files** as markdown in `memory/` folder
- **Hybrid search**: Vector (SQLite) + keyword (FTS5)
- Agent writes memory using standard file write tool - no special API
- No forgetting curve - old memories have equal weight

> "I'm always in favor of explainable simplicity rather than complex spaghetti."

## Computer Use

- **Exec tool** - Shell commands in sandbox (Docker), host, or remote
- **Filesystem tools** - Read, write, edit
- **Browser tool** - Playwright-based with semantic snapshots
- **Process management** - Background commands, kill processes

## Safety Model

- Allowlist for command approval (allow once, always, deny)
- Safe commands pre-approved (jq, grep, cut, sort, etc.)
- Dangerous shell constructs blocked by default (command substitution, redirections, subshells)

## Browser: Semantic Snapshots

Uses accessibility tree (ARIA) instead of screenshots:

```text
- button "Sign In" [ref=1]
- textbox "Email" [ref=2]
- link "Forgot password?" [ref=4]
```

Advantages:
- ~50 KB vs 5 MB for screenshots
- Fraction of token cost
- Browsing isn't necessarily a visual task
